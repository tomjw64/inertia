use std::collections::hash_map::Entry;
use std::collections::HashMap;

const ZOBRIST_CONSTANTS: [u64; 256] = [
  16501952026610695622,
  12196922252699404725,
  17713627773198012505,
  45989444808335734,
  7010653953475518520,
  15142661068214952331,
  7201958530142699166,
  6024385482969975490,
  9982235522011934788,
  17098469545625369353,
  9237325973302837476,
  7536071072175692624,
  7545463613760800172,
  12804516659355813095,
  5394759539215147531,
  12044263353943497440,
  12881496417392101781,
  14084592678336406160,
  3083401619479923493,
  16028801719116131105,
  3785740599107059964,
  8343157398844864086,
  11679869127685584449,
  6976158568141836979,
  15829556130798250230,
  13867872084069701398,
  8705891925258966795,
  12404650195503340663,
  11465193025012605662,
  16581551810038182996,
  5849676082720059230,
  2999887071766794806,
  5862319301714305514,
  1361863171925664936,
  7860360286039477367,
  133314415452664579,
  9588238196918163600,
  18435954218399183859,
  14281305102610872810,
  17004346614629304374,
  15847117854432701789,
  246037843369145921,
  11005433306952216892,
  8141879494603300037,
  7839022349158903548,
  7839712134796638198,
  17885736478086283567,
  16454136659194886138,
  9844346753736962560,
  4936201677759206386,
  5587815364485388506,
  11034071447557220708,
  10378424277261676546,
  17566162566258180602,
  1190471407779730899,
  6339585914760576075,
  17370675461554781204,
  2867843511210652885,
  9246883406690871498,
  9095341667261746266,
  4062796303167283421,
  12111128153978436476,
  692774519722276580,
  5458697126731289949,
  7029590521083025071,
  10247649152621065828,
  2409873811179768254,
  13535145804450925035,
  15924380516751813373,
  13390110092244518718,
  8695015032492733232,
  17860985334259852221,
  10891727382392354144,
  16619633465764793773,
  12775021695401384649,
  1272063703876369523,
  3107045665227652872,
  6372847072294556232,
  510563686632196548,
  15223431027892521026,
  13233551508016124569,
  13909149686760870581,
  9709849883197138971,
  9355927802632845988,
  5747088658074253763,
  9962511781524032548,
  16653034414864142770,
  11346015514848500224,
  16368109597048355053,
  10065493609933183837,
  2445972120558535527,
  407034660203057668,
  18418665758066342284,
  5609531343950549348,
  15863533115459722330,
  15621398177565904578,
  18435355756628617599,
  14220943081721832554,
  2875573954684209237,
  11602102794047940974,
  17767446479549247964,
  6277178300329590747,
  11500204565955406444,
  8739921455553564271,
  18446395050843599626,
  577211129866313766,
  7162159998919720179,
  18122627770272895752,
  8583175291940496172,
  4730540366354347279,
  5596587916682072828,
  6014887737746667999,
  15188755400175572921,
  9659838990032924289,
  3245427615865879699,
  10857873271573844412,
  11233486231887786511,
  17713630995224385742,
  16410008416636720481,
  5510108148920198231,
  15488289889702644383,
  1234744287475626406,
  7415645865817511447,
  2684655756194445254,
  15347573168947826831,
  15622298583293026700,
  14309750778271884731,
  8683251676555941311,
  3462381001252677490,
  5362572868598358562,
  14422867603492558121,
  6373261885209873383,
  9994481047427599601,
  892129792714298469,
  11647205381842317046,
  4258112171741382390,
  10711388604383789242,
  15912315101725627937,
  6649715134304970921,
  1287041786153167172,
  9156060456268653726,
  14844792540059799004,
  9584233442836449426,
  8499269976057288474,
  5416778729070258702,
  4819467751377980136,
  18396738958670236466,
  1112569305091035665,
  1282851304259810306,
  8855399545619054160,
  10937498349456455511,
  8167303731983082464,
  1993440760660854584,
  2434222992536315395,
  17219809876092084842,
  1685935781067675646,
  9595243603581067806,
  15789069142840399625,
  2680155120926466498,
  15856384111190283771,
  9396121125246244938,
  17029726131576388670,
  10330931843195800710,
  7713865594847282656,
  15602324669582189940,
  479270407886641872,
  5851241696728738137,
  77537451174731836,
  13553214844513887672,
  3213574458713726415,
  11137409270608938110,
  626317058916144297,
  2050215708082655490,
  14778948235198537253,
  17492552163442932271,
  1837488779166206545,
  12298227988381686761,
  8819039477175022803,
  13631998146080925044,
  10224214893738089340,
  2907378152425413658,
  7300870721128734541,
  17430523392943886178,
  12835016134364874418,
  5962451562635362950,
  3245676777793886635,
  9959517900151407744,
  7054267270598611426,
  13726397722927003851,
  6335605435404259302,
  7708542535475962243,
  12819222339491257703,
  4712401195219734487,
  17468052543001438616,
  11968310022253232492,
  10312358614411226347,
  1629249326839379021,
  8124529446852636321,
  10304158402534246639,
  6413483750417355350,
  5054361590840458657,
  8714868648649891358,
  842915787475932128,
  7317643394946730733,
  16203059925350565895,
  2243872372040832149,
  2988918052829757608,
  8465209183073340364,
  12716640761865484773,
  14550420306311530388,
  11114646012045590281,
  11711605157307118098,
  3690557431448655486,
  6429407820785390284,
  5361740125032154625,
  8058429143580929054,
  3879293492657601213,
  2891866461099864270,
  9319163026378161078,
  17011313547724313805,
  12031344685449998454,
  839424089922916841,
  15478704990600599416,
  4762055512685046846,
  17913552442783260940,
  11974581591409239683,
  14074840442264629870,
  9510191379710523026,
  15255521504103806061,
  8502363238111252290,
  9658127508343775517,
  14055981935184999151,
  9785496810032938446,
  10786639605375156211,
  17210004152169331218,
  16500601907212783701,
  10895955865621693822,
  6251249550660271038,
  3522360129786960670,
  11928551535870785355,
  16461100105822226958,
  14434823555985495033,
  8549963771099806820,
  16020763742810283309,
  6674334777337348206,
  18114269229248357076,
  8090433993585054564,
  2947784725805086505,
  8184662228424286599,
  348957659540029571,
  17756524097120560331,
  18216474184934215248,
  12909884718824615220,
  11484155338435173444,
  667173190732128981,
  17492173339088777755,
];

const EXPECTED_ELEMENT_COUNT: usize = 255 * 254 * 253 * 252 / 24;

pub fn zobrist_hash(bytes: [u8; 4]) -> u64 {
  ZOBRIST_CONSTANTS[bytes[0] as usize]
    ^ ZOBRIST_CONSTANTS[bytes[1] as usize]
    ^ ZOBRIST_CONSTANTS[bytes[2] as usize]
    ^ ZOBRIST_CONSTANTS[bytes[3] as usize]
}

fn main() {
  let mut map = HashMap::<u64, [u8; 4]>::with_capacity(EXPECTED_ELEMENT_COUNT);

  for i in 0..=252 {
    println!("Progress: {}/255", i);
    for j in (i + 1)..=253 {
      for m in (j + 1)..=254 {
        for n in (m + 1)..=255 {
          let input = [i, j, m, n];
          let hash = zobrist_hash(input);
          match map.entry(hash) {
            Entry::Occupied(duplicate) => {
              println!("Duplicate: {:?}, {:?}", duplicate.get(), input);
            }
            Entry::Vacant(entry) => {
              entry.insert(input);
            }
          }
        }
      }
    }
  }
  println!("Finished with {} entries", map.len());
}
